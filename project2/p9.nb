(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66573,       1791]
NotebookOptionsPosition[     61642,       1633]
NotebookOutlinePosition[     61999,       1649]
CellTagsIndexPosition[     61956,       1646]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "@", 
  RowBox[{"NotebookDirectory", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.7059571105099583`*^9, 3.7059571173957863`*^9}}],

Cell[BoxData["\<\"/Users/yunqiguo/Document/EE232/proj2/src\"\>"], "Output",
 CellChangeTimes->{3.705957118153512*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pre", "Subchapter",
 CellChangeTimes->{{3.705957336395195*^9, 3.7059573368865557`*^9}}],

Cell[BoxData[
 RowBox[{"<<", "actor.mx"}]], "Input",
 CellChangeTimes->{{3.705886448204623*^9, 3.70588644947511*^9}, {
  3.7058865211523123`*^9, 3.705886540860805*^9}, {3.705886736746669*^9, 
  3.7058867469312057`*^9}, {3.705886792848686*^9, 3.705886805992215*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actorMap", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "t"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "&"}], "/@",
       "actor"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705887073840351*^9, 3.705887244844191*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actorMap", "=", 
   RowBox[{"GroupBy", "[", 
    RowBox[{"actorMap", ",", 
     RowBox[{"Last", "\[Rule]", "First"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705887250274455*^9, 3.705887285423736*^9}, {
  3.7058873359253407`*^9, 3.705887372712577*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"movieActor", "=", "actorMap"}], ";"}]], "Input",
 CellChangeTimes->{{3.7058881563795557`*^9, 3.705888181707427*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", "actorMap"}]], "Input",
 CellChangeTimes->{{3.705887393242238*^9, 3.705887412027925*^9}}],

Cell[BoxData["879201"], "Output",
 CellChangeTimes->{{3.7058873988242273`*^9, 3.705887412398106*^9}, 
   3.7058940064854107`*^9, 3.705945841751038*^9, 3.7059471781775827`*^9, 
   3.7059552374073267`*^9, 3.705955537533959*^9, {3.705957356636113*^9, 
   3.705957382887001*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"actScore", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{"\"\<../data/actScore.txt\>\"", ",", "\"\<Data\>\""}], "]"}], 
    "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705887477107727*^9, 3.705887550825737*^9}, {
  3.7058882693815317`*^9, 3.705888269709593*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actName", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{"\"\<../data/actRank.txt\>\"", ",", "\"\<Data\>\""}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"3", ";;", "4"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705887552730756*^9, 3.7058876159677687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actScore", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"actName", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Rule]", 
       RowBox[{"actScore", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "actName"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.705888198854476*^9, 3.7058882470301247`*^9}, {
  3.7058886841825542`*^9, 3.705888685741508*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actMovieNumbers", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"actName", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Rule]", 
       RowBox[{"actName", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "actName"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7059501834975023`*^9, 3.705950198096211*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"topDirector", "=", 
   RowBox[{
    RowBox[{"Import", "[", "\"\<../data/top_100_director.txt\>\"", "]"}], "~",
     "StringSplit", "~", "\"\<\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topDirector", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"topDirector", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", "i"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "100"}], "}"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.705887687249061*^9, 3.705887731434445*^9}, {
  3.70589253478857*^9, 3.705892535068913*^9}, {3.705893088008607*^9, 
  3.705893089921007*^9}, {3.705893159572657*^9, 3.705893194041375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"movieDirector", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<../data/director_movies.txt\>\"", ",", "\"\<String\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705887743779792*^9, 3.705887793388966*^9}, {
  3.705888053726431*^9, 3.705888054708645*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cleanData", "[", "str_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"actors", ",", "cleanedActorData"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"actors", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"str", ",", "\"\<\\n\>\""}], "]"}]}], ";", 
     RowBox[{"actors", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringSplit", "[", 
          RowBox[{"#", ",", "\"\<\\t\\t\>\""}], "]"}], "&"}], ",", "actors"}],
        "]"}]}], ";", 
     RowBox[{"actors", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"actors", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "#", "]"}], ">", "4"}], "&"}]}], "]"}]}], 
     ";", 
     RowBox[{"Return", "@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"StartOfString", " ", "~~", "Whitespace"}], ")"}], " ", 
             "|", " ", 
             RowBox[{"(", 
              RowBox[{"Whitespace", " ", "~~", " ", "EndOfString"}], ")"}]}], 
            " ", "\[Rule]", " ", "\"\<\>\""}]}], "]"}], "&"}], ",", "actors", 
        ",", "2"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7045724269249*^9, 3.704572540137429*^9}, {
  3.704572586172279*^9, 3.704572594015497*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"movieDirector", "=", 
   RowBox[{"cleanData", "@", "movieDirector"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705888066160068*^9, 3.7058880780067368`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"movieDirector", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"t", "->", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "&"}], "/@",
        "movieDirector"}], ",", "1"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7058878590139513`*^9, 3.705887936732687*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"movieList", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{"\"\<../data/newMovieList.txt\>\"", ",", "\"\<String\>\""}], 
     "]"}], "~", "StringSplit", "~", "\"\<\\n\>\"", "~", "StringSplit", "~", 
    "\"\<\\t\\t\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705888330495688*^9, 3.7058883870010023`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"movieList", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"movieList", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "3"}], "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7058883947063007`*^9, 3.70588842457869*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sort", "[", 
  RowBox[{"TakeLargest", "[", 
   RowBox[{
    RowBox[{"actScore", "/@", 
     RowBox[{"movieActor", "[", 
      RowBox[{"movieList", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "1"}], "]"}], "]"}], "]"}]}], ",", "5"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.70588858811551*^9, 3.705888645590609*^9}, {
  3.70588872095026*^9, 3.705888735061893*^9}, {3.705894135338397*^9, 
  3.7058941443557873`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5.98228196736408`*^-6", ",", "7.20387823660354`*^-6", ",", 
   "0.0000102305217852378`", ",", "0.0000115492308256078`", ",", 
   "0.0000253019320361306`"}], "}"}]], "Output",
 CellChangeTimes->{{3.705888593940488*^9, 3.705888646028368*^9}, {
   3.705888714115036*^9, 3.705888735505559*^9}, {3.705894108652546*^9, 
   3.7058941446589746`*^9}, 3.70594585878724*^9, 3.705947231069519*^9, 
   3.7059552550221233`*^9, 3.705955555080472*^9, 3.7059574000597363`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"directorRank", "[", "str_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "[", 
        RowBox[{"movieDirector", "[", "str", "]"}], "]"}], ",", 
       RowBox[{"Return", "@", "101"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"topDirector", "[", 
       RowBox[{"movieDirector", "[", "str", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "[", "tmp", "]"}], ",", 
       RowBox[{"Return", "@", "101"}], ",", 
       RowBox[{"Return", "@", "tmp"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.705889138685294*^9, 3.705889204176799*^9}, {
  3.705889267993929*^9, 3.705889312940436*^9}, {3.70589237865562*^9, 
  3.705892421218392*^9}, {3.705892455571916*^9, 3.705892468557268*^9}, {
  3.705892517020739*^9, 3.7058925484666643`*^9}, {3.705892639939843*^9, 
  3.705892642871418*^9}, {3.7058926993715553`*^9, 3.705892727600103*^9}, {
  3.7058927598068037`*^9, 3.7058927629055653`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"selectSet", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"movieList", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"movieActor", "@", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "\[GreaterEqual]", "5"}], 
      "&"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705894202282024*^9, 3.7058943790697193`*^9}, {
  3.7058944280867367`*^9, 3.705894452390748*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", "selectSet"}]], "Input",
 CellChangeTimes->{{3.7058944322980556`*^9, 3.70589443474507*^9}}],

Cell[BoxData["96125"], "Output",
 CellChangeTimes->{{3.705894435151538*^9, 3.705894454163085*^9}, 
   3.70594586947565*^9, 3.70594724947643*^9, 3.7059552553822727`*^9, 
   3.7059555554514093`*^9, 3.705957400369248*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["p9(Wrong)", "Subchapter",
 CellChangeTimes->{{3.70595741173455*^9, 3.7059574123695374`*^9}, {
  3.7059612467491207`*^9, 3.7059612611740723`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"movieList", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.705958519770453*^9, 3.705958522822831*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Suuri illusioni (1985)\"\>", ",", "\<\"Romance\"\>", ",", 
   "4.`"}], "}"}]], "Output",
 CellChangeTimes->{3.7059585231149187`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"movieScore", " ", "=", " ", 
   RowBox[{"Association", "@", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "&"}], ",", "movieList"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705958528306396*^9, 3.705958574460082*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actScore2", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"t", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
       RowBox[{"Mean", "[", 
        RowBox[{"Select", "[", " ", 
         RowBox[{
          RowBox[{"movieScore", "/@", 
           RowBox[{"t", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MissingQ", "@", "#"}]}], "&"}]}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "actor"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705958400188362*^9, 3.705958417672564*^9}, {
   3.705958465585651*^9, 3.705958506226141*^9}, {3.7059585906555777`*^9, 
   3.70595867122834*^9}, {3.7059587438334007`*^9, 3.7059587482747927`*^9}, {
   3.705958818713901*^9, 3.7059588385087767`*^9}, 3.705958894947596*^9, {
   3.7059592767586803`*^9, 3.7059592786593647`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"genreMovies", "=", 
   RowBox[{"GroupBy", "[", 
    RowBox[{"selectSet", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "&"}], "\[Rule]", "First"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705955828469256*^9, 3.7059559047107277`*^9}, {
  3.705955940805464*^9, 3.705955957527381*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"movieScore", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"t", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
       RowBox[{"t", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "selectSet"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7059560009758253`*^9, 3.705956051461524*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"genreScore", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"t", "\[Rule]", 
       RowBox[{"Mean", "[", 
        RowBox[{"movieScore", "/@", 
         RowBox[{"genreMovies", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"Keys", "@", "genreMovies"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7059559609832153`*^9, 3.7059559959189796`*^9}, {
  3.705956075057523*^9, 3.70595614131947*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actScore2", "=", 
   RowBox[{
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"Mean", "[", 
       RowBox[{"{", "}"}], "]"}], "\[Rule]", "6.0176"}], "]"}], "[", 
    "actScore2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705959467797785*^9, 3.705959498344245*^9}, {
  3.705959548221932*^9, 3.705959596851985*^9}, {3.705959717286941*^9, 
  3.705959730379526*^9}, {3.705959788188711*^9, 3.705959789480543*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"feature", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Length", "[", 
         RowBox[{"actMovieNumbers", "/@", 
          RowBox[{"movieActor", "[", 
           RowBox[{"selectSet", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], "}"}], 
       ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"TakeLargest", "[", 
         RowBox[{
          RowBox[{"actMovieNumbers", "/@", 
           RowBox[{"movieActor", "[", 
            RowBox[{"selectSet", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], ",", "5"}], 
         "]"}], "]"}], ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"TakeLargest", "[", 
         RowBox[{
          RowBox[{"actScore2", "/@", 
           RowBox[{"movieActor", "[", 
            RowBox[{"selectSet", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], ",", "5"}], 
         "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"genreScore", "[", 
         RowBox[{"selectSet", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "}"}], ",", 
       RowBox[{"selectSet", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "selectSet"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.705893324600802*^9, 3.705893458486784*^9}, 
   3.7058943988779182`*^9, 3.705894468968957*^9, 3.7058945683208838`*^9, {
   3.705894816554983*^9, 3.705894840973228*^9}, 3.705899212094575*^9, {
   3.705899277843981*^9, 3.705899324825976*^9}, {3.7059015863403473`*^9, 
   3.705901662908539*^9}, {3.70590171019634*^9, 3.705901770678465*^9}, {
   3.705946466387496*^9, 3.70594647634916*^9}, {3.705948894588585*^9, 
   3.705948911527807*^9}, {3.7059503843261423`*^9, 3.705950385323543*^9}, {
   3.705954569440332*^9, 3.705954609562771*^9}, {3.7059547524915667`*^9, 
   3.705954785136129*^9}, {3.705955561975618*^9, 3.7059555640983047`*^9}, {
   3.705956181821609*^9, 3.705956223305291*^9}, {3.7059591001358137`*^9, 
   3.7059591187196407`*^9}, {3.7059591731652927`*^9, 3.705959196129171*^9}, {
   3.705959870942175*^9, 3.7059598995214853`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"feature", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.705959816378578*^9, 3.705959817846349*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "11", ",", "27", ",", "30", ",", "39", ",", "43", ",", "70", ",", "5.7`", 
   ",", "5.763636363636365`", ",", "5.766666666666666`", ",", 
   "5.8181818181818175`", ",", "5.870967741935484`", ",", 
   "6.090073972131393`", ",", "\<\"Romance\"\>", 
   ",", "\<\"Suuri illusioni (1985)\"\>", ",", "4.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7059598181189013`*^9, {3.705959877370474*^9, 3.7059599062741117`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"trainingFeature", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "4"}]}], "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"feature", "[", 
     RowBox[{"[", "All", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705901714049345*^9, 3.705901715831077*^9}, {
  3.705946537758575*^9, 3.705946597252083*^9}, {3.705946634652025*^9, 
  3.705946719426502*^9}, {3.705946853643268*^9, 3.705946859953978*^9}, {
  3.705948269394189*^9, 3.705948275851774*^9}, {3.705949005642078*^9, 
  3.7059490060786057`*^9}, {3.7059562395781317`*^9, 3.705956240096857*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"train", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"trainingFeature", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "\[GreaterEqual]", "0"}], "&"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705888455669897*^9, 3.705888498873867*^9}, {
   3.70589451417284*^9, 3.705894514891714*^9}, {3.705894867072895*^9, 
   3.705894870896069*^9}, 3.705946730487412*^9, {3.705947596839113*^9, 
   3.705947600820406*^9}, 3.7059482826183443`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"trainingFeature", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "<", "0"}], "&"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7058885010675907`*^9, 3.705888523640967*^9}, {
   3.7058945177900333`*^9, 3.705894527343845*^9}, {3.7058948780464277`*^9, 
   3.705894885107299*^9}, 3.705946731355507*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"train", "=", 
   RowBox[{"RandomSample", "@", "train"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7058949338344173`*^9, 3.705894953298543*^9}, {
  3.705895136631789*^9, 3.705895165842526*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"trainSplit", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{"train", ",", 
     RowBox[{"Floor", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "@", "train"}], "/", "5"}], ")"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.705895171060305*^9, 3.70589524621029*^9}, 
   3.705897991442871*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pm", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Print", "@", "i"}], ";", "\[IndentingNewLine]", 
    RowBox[{"training", "=", 
     RowBox[{"Catenate", "[", 
      RowBox[{"Drop", "[", 
       RowBox[{"trainSplit", ",", 
        RowBox[{"{", "i", "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"testing", " ", "=", " ", 
     RowBox[{"trainSplit", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p", "=", 
     RowBox[{"Predict", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"training", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{"training", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<NeuralNetwork\>\""}]}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"testset", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
        RowBox[{"t", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "testing"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp", "=", 
     RowBox[{"PredictorMeasurements", "[", 
      RowBox[{"p", ",", "testset"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"tmp", "[", "\"\<StandardDeviation\>\"", "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"pm", ",", "tmp"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "5"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",\

 CellChangeTimes->{{3.70589546725629*^9, 3.705895504514803*^9}, {
   3.70589554571253*^9, 3.705895718455051*^9}, {3.7058958636400967`*^9, 
   3.705895911975482*^9}, {3.705896146985751*^9, 3.705896154755711*^9}, {
   3.705896190007964*^9, 3.705896334631234*^9}, {3.705897368597191*^9, 
   3.705897369931838*^9}, {3.7058974338808117`*^9, 3.7058974750296183`*^9}, 
   3.705898013569848*^9, {3.705898858684855*^9, 3.70589885946903*^9}, {
   3.705899565082034*^9, 3.705899570089501*^9}, {3.705900139140503*^9, 
   3.705900159147534*^9}, {3.7059018314930553`*^9, 3.705901846486944*^9}, {
   3.705946948903064*^9, 3.705946963850882*^9}, {3.705948952907061*^9, 
   3.70594897257146*^9}, {3.705949071859201*^9, 3.7059490760765867`*^9}, {
   3.705955130645319*^9, 3.705955134401701*^9}, {3.705955338885998*^9, 
   3.7059553424419737`*^9}, {3.7059553745814*^9, 3.705955376810484*^9}, {
   3.705955410218156*^9, 3.705955413900382*^9}, {3.705955655545445*^9, 
   3.705955657753468*^9}, {3.7059566367556334`*^9, 3.7059566405270557`*^9}, {
   3.70595996802477*^9, 3.705959974021201*^9}, {3.7059602997513742`*^9, 
   3.705960308823217*^9}}],

Cell[CellGroupData[{

Cell[BoxData["1"], "Print",
 CellChangeTimes->{{3.7058963279176493`*^9, 3.7058963350564623`*^9}, 
   3.7058975215121393`*^9, 3.705898021854598*^9, 3.7058988602614527`*^9, 
   3.705899371298514*^9, 3.705899570611031*^9, 3.705899982600831*^9, 
   3.705900162764223*^9, 3.705901854043725*^9, 3.7059469645891457`*^9, 
   3.705947612667206*^9, 3.705948289679666*^9, 3.705949131084667*^9, 
   3.705950414072514*^9, 3.705954638662236*^9, 3.705954805099276*^9, 
   3.705955134843645*^9, 3.705955277104496*^9, 3.705955377158184*^9, 
   3.705955414231538*^9, 3.705955594074896*^9, 3.70595565814603*^9, 
   3.7059562607063093`*^9, 3.705956640916767*^9, 3.7059599749551277`*^9, 
   3.705960309252317*^9}],

Cell[BoxData["0.7405776231892108`"], "Print",
 CellChangeTimes->{{3.7058963279176493`*^9, 3.7058963350564623`*^9}, 
   3.7058975215121393`*^9, 3.705898021854598*^9, 3.7058988602614527`*^9, 
   3.705899371298514*^9, 3.705899570611031*^9, 3.705899982600831*^9, 
   3.705900162764223*^9, 3.705901854043725*^9, 3.7059469645891457`*^9, 
   3.705947612667206*^9, 3.705948289679666*^9, 3.705949131084667*^9, 
   3.705950414072514*^9, 3.705954638662236*^9, 3.705954805099276*^9, 
   3.705955134843645*^9, 3.705955277104496*^9, 3.705955377158184*^9, 
   3.705955414231538*^9, 3.705955594074896*^9, 3.70595565814603*^9, 
   3.7059562607063093`*^9, 3.705956640916767*^9, 3.7059599749551277`*^9, 
   3.705960331902705*^9}],

Cell[BoxData["2"], "Print",
 CellChangeTimes->{{3.7058963279176493`*^9, 3.7058963350564623`*^9}, 
   3.7058975215121393`*^9, 3.705898021854598*^9, 3.7058988602614527`*^9, 
   3.705899371298514*^9, 3.705899570611031*^9, 3.705899982600831*^9, 
   3.705900162764223*^9, 3.705901854043725*^9, 3.7059469645891457`*^9, 
   3.705947612667206*^9, 3.705948289679666*^9, 3.705949131084667*^9, 
   3.705950414072514*^9, 3.705954638662236*^9, 3.705954805099276*^9, 
   3.705955134843645*^9, 3.705955277104496*^9, 3.705955377158184*^9, 
   3.705955414231538*^9, 3.705955594074896*^9, 3.70595565814603*^9, 
   3.7059562607063093`*^9, 3.705956640916767*^9, 3.7059599749551277`*^9, 
   3.705960331914028*^9}],

Cell[BoxData["0.7397715443840507`"], "Print",
 CellChangeTimes->{{3.7058963279176493`*^9, 3.7058963350564623`*^9}, 
   3.7058975215121393`*^9, 3.705898021854598*^9, 3.7058988602614527`*^9, 
   3.705899371298514*^9, 3.705899570611031*^9, 3.705899982600831*^9, 
   3.705900162764223*^9, 3.705901854043725*^9, 3.7059469645891457`*^9, 
   3.705947612667206*^9, 3.705948289679666*^9, 3.705949131084667*^9, 
   3.705950414072514*^9, 3.705954638662236*^9, 3.705954805099276*^9, 
   3.705955134843645*^9, 3.705955277104496*^9, 3.705955377158184*^9, 
   3.705955414231538*^9, 3.705955594074896*^9, 3.70595565814603*^9, 
   3.7059562607063093`*^9, 3.705956640916767*^9, 3.7059599749551277`*^9, 
   3.705960354478016*^9}],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{{3.7058963279176493`*^9, 3.7058963350564623`*^9}, 
   3.7058975215121393`*^9, 3.705898021854598*^9, 3.7058988602614527`*^9, 
   3.705899371298514*^9, 3.705899570611031*^9, 3.705899982600831*^9, 
   3.705900162764223*^9, 3.705901854043725*^9, 3.7059469645891457`*^9, 
   3.705947612667206*^9, 3.705948289679666*^9, 3.705949131084667*^9, 
   3.705950414072514*^9, 3.705954638662236*^9, 3.705954805099276*^9, 
   3.705955134843645*^9, 3.705955277104496*^9, 3.705955377158184*^9, 
   3.705955414231538*^9, 3.705955594074896*^9, 3.70595565814603*^9, 
   3.7059562607063093`*^9, 3.705956640916767*^9, 3.7059599749551277`*^9, 
   3.70596035448981*^9}],

Cell[BoxData["0.7446425087622035`"], "Print",
 CellChangeTimes->{{3.7058963279176493`*^9, 3.7058963350564623`*^9}, 
   3.7058975215121393`*^9, 3.705898021854598*^9, 3.7058988602614527`*^9, 
   3.705899371298514*^9, 3.705899570611031*^9, 3.705899982600831*^9, 
   3.705900162764223*^9, 3.705901854043725*^9, 3.7059469645891457`*^9, 
   3.705947612667206*^9, 3.705948289679666*^9, 3.705949131084667*^9, 
   3.705950414072514*^9, 3.705954638662236*^9, 3.705954805099276*^9, 
   3.705955134843645*^9, 3.705955277104496*^9, 3.705955377158184*^9, 
   3.705955414231538*^9, 3.705955594074896*^9, 3.70595565814603*^9, 
   3.7059562607063093`*^9, 3.705956640916767*^9, 3.7059599749551277`*^9, 
   3.705960381985744*^9}],

Cell[BoxData["4"], "Print",
 CellChangeTimes->{{3.7058963279176493`*^9, 3.7058963350564623`*^9}, 
   3.7058975215121393`*^9, 3.705898021854598*^9, 3.7058988602614527`*^9, 
   3.705899371298514*^9, 3.705899570611031*^9, 3.705899982600831*^9, 
   3.705900162764223*^9, 3.705901854043725*^9, 3.7059469645891457`*^9, 
   3.705947612667206*^9, 3.705948289679666*^9, 3.705949131084667*^9, 
   3.705950414072514*^9, 3.705954638662236*^9, 3.705954805099276*^9, 
   3.705955134843645*^9, 3.705955277104496*^9, 3.705955377158184*^9, 
   3.705955414231538*^9, 3.705955594074896*^9, 3.70595565814603*^9, 
   3.7059562607063093`*^9, 3.705956640916767*^9, 3.7059599749551277`*^9, 
   3.7059603819962263`*^9}],

Cell[BoxData["0.7459036061918981`"], "Print",
 CellChangeTimes->{{3.7058963279176493`*^9, 3.7058963350564623`*^9}, 
   3.7058975215121393`*^9, 3.705898021854598*^9, 3.7058988602614527`*^9, 
   3.705899371298514*^9, 3.705899570611031*^9, 3.705899982600831*^9, 
   3.705900162764223*^9, 3.705901854043725*^9, 3.7059469645891457`*^9, 
   3.705947612667206*^9, 3.705948289679666*^9, 3.705949131084667*^9, 
   3.705950414072514*^9, 3.705954638662236*^9, 3.705954805099276*^9, 
   3.705955134843645*^9, 3.705955277104496*^9, 3.705955377158184*^9, 
   3.705955414231538*^9, 3.705955594074896*^9, 3.70595565814603*^9, 
   3.7059562607063093`*^9, 3.705956640916767*^9, 3.7059599749551277`*^9, 
   3.705960401379796*^9}],

Cell[BoxData["5"], "Print",
 CellChangeTimes->{{3.7058963279176493`*^9, 3.7058963350564623`*^9}, 
   3.7058975215121393`*^9, 3.705898021854598*^9, 3.7058988602614527`*^9, 
   3.705899371298514*^9, 3.705899570611031*^9, 3.705899982600831*^9, 
   3.705900162764223*^9, 3.705901854043725*^9, 3.7059469645891457`*^9, 
   3.705947612667206*^9, 3.705948289679666*^9, 3.705949131084667*^9, 
   3.705950414072514*^9, 3.705954638662236*^9, 3.705954805099276*^9, 
   3.705955134843645*^9, 3.705955277104496*^9, 3.705955377158184*^9, 
   3.705955414231538*^9, 3.705955594074896*^9, 3.70595565814603*^9, 
   3.7059562607063093`*^9, 3.705956640916767*^9, 3.7059599749551277`*^9, 
   3.705960401390395*^9}],

Cell[BoxData["0.7414987728860155`"], "Print",
 CellChangeTimes->{{3.7058963279176493`*^9, 3.7058963350564623`*^9}, 
   3.7058975215121393`*^9, 3.705898021854598*^9, 3.7058988602614527`*^9, 
   3.705899371298514*^9, 3.705899570611031*^9, 3.705899982600831*^9, 
   3.705900162764223*^9, 3.705901854043725*^9, 3.7059469645891457`*^9, 
   3.705947612667206*^9, 3.705948289679666*^9, 3.705949131084667*^9, 
   3.705950414072514*^9, 3.705954638662236*^9, 3.705954805099276*^9, 
   3.705955134843645*^9, 3.705955277104496*^9, 3.705955377158184*^9, 
   3.705955414231538*^9, 3.705955594074896*^9, 3.70595565814603*^9, 
   3.7059562607063093`*^9, 3.705956640916767*^9, 3.7059599749551277`*^9, 
   3.705960425604704*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p", "/@", 
  RowBox[{"test", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7059605054293633`*^9, 3.705960505971899*^9}, {
  3.705961006455175*^9, 3.705961026003693*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.7516014592362943`", ",", "3.737865033359774`", ",", 
   "4.155387561285011`"}], "}"}]], "Output",
 CellChangeTimes->{3.705960506496429*^9, 3.705961026295837*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sd", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"pm", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<StandardDeviation\>\"", 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.705896239044763*^9, {3.7058970562042303`*^9, 3.7058970834160347`*^9}, {
   3.705897117133807*^9, 3.705897179039836*^9}, 3.705898349760479*^9, {
   3.7058995178544893`*^9, 3.705899520679878*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "@", "sd"}]], "Input",
 CellChangeTimes->{{3.705897180243259*^9, 3.705897182646003*^9}, {
  3.705897222041327*^9, 3.705897223063382*^9}}],

Cell[BoxData["0.7424788110826758`"], "Output",
 CellChangeTimes->{3.705897183035335*^9, 3.7058972243016863`*^9, 
  3.705898365991908*^9, 3.705899125497547*^9, 3.7058994924239073`*^9, 
  3.705899522892642*^9, 3.705899760428165*^9, 3.705948627241386*^9, 
  3.7059494918311996`*^9, 3.705951205341064*^9, 3.7059566116100197`*^9, 
  3.7059610899146557`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<../result/p9_1(error).txt\>\"", ",", 
   RowBox[{"Append", "[", 
    RowBox[{"sd", ",", 
     RowBox[{"Mean", "@", "sd"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.705897245551197*^9, 3.705897278903693*^9}, {
  3.7058991040281477`*^9, 3.7058991045203257`*^9}, {3.70596109655425*^9, 
  3.705961102820471*^9}}],

Cell[BoxData["\<\"../result/p9_1(error).txt\"\>"], "Output",
 CellChangeTimes->{3.705897287761566*^9, 3.705898430165163*^9, 
  3.705899145295381*^9, 3.705899527467272*^9, 3.705899763848359*^9, 
  3.70594864318449*^9, 3.705949498114317*^9, 3.705951212559217*^9, 
  3.705961103472625*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["p9 improve", "Subchapter",
 CellChangeTimes->{{3.70595741173455*^9, 3.7059574123695374`*^9}, {
  3.7059612467491207`*^9, 3.7059612611740723`*^9}, {3.705974432887373*^9, 
  3.705974436469997*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"movieScore", " ", "=", " ", 
   RowBox[{"Association", "@", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "&"}], ",", "movieList"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705958528306396*^9, 3.705958574460082*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actScore2", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"t", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
       RowBox[{"Mean", "[", 
        RowBox[{"Select", "[", " ", 
         RowBox[{
          RowBox[{"movieScore", "/@", 
           RowBox[{"t", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MissingQ", "@", "#"}]}], "&"}]}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "actor"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705958400188362*^9, 3.705958417672564*^9}, {
   3.705958465585651*^9, 3.705958506226141*^9}, {3.7059585906555777`*^9, 
   3.70595867122834*^9}, {3.7059587438334007`*^9, 3.7059587482747927`*^9}, {
   3.705958818713901*^9, 3.7059588385087767`*^9}, 3.705958894947596*^9, {
   3.7059592767586803`*^9, 3.7059592786593647`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"genreMovies", "=", 
   RowBox[{"GroupBy", "[", 
    RowBox[{"selectSet", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "&"}], "\[Rule]", "First"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705955828469256*^9, 3.7059559047107277`*^9}, {
  3.705955940805464*^9, 3.705955957527381*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"movieScore", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"t", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
       RowBox[{"t", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "selectSet"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7059560009758253`*^9, 3.705956051461524*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"genreScore", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"t", "\[Rule]", 
       RowBox[{"Mean", "[", 
        RowBox[{"movieScore", "/@", 
         RowBox[{"genreMovies", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"Keys", "@", "genreMovies"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7059559609832153`*^9, 3.7059559959189796`*^9}, {
  3.705956075057523*^9, 3.70595614131947*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actScore2", "=", 
   RowBox[{
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"Mean", "[", 
       RowBox[{"{", "}"}], "]"}], "\[Rule]", "6.0176"}], "]"}], "[", 
    "actScore2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705959467797785*^9, 3.705959498344245*^9}, {
  3.705959548221932*^9, 3.705959596851985*^9}, {3.705959717286941*^9, 
  3.705959730379526*^9}, {3.705959788188711*^9, 3.705959789480543*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"feature", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Length", "[", 
         RowBox[{"actMovieNumbers", "/@", 
          RowBox[{"movieActor", "[", 
           RowBox[{"selectSet", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], "}"}], 
       ",", 
       RowBox[{"Sort", "[", 
        RowBox[{"TakeLargest", "[", 
         RowBox[{
          RowBox[{"actMovieNumbers", "/@", 
           RowBox[{"movieActor", "[", 
            RowBox[{"selectSet", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], ",", "5"}], 
         "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"genreScore", "[", 
         RowBox[{"selectSet", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "}"}], ",", 
       RowBox[{"selectSet", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "selectSet"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.705893324600802*^9, 3.705893458486784*^9}, 
   3.7058943988779182`*^9, 3.705894468968957*^9, 3.7058945683208838`*^9, {
   3.705894816554983*^9, 3.705894840973228*^9}, 3.705899212094575*^9, {
   3.705899277843981*^9, 3.705899324825976*^9}, {3.7059015863403473`*^9, 
   3.705901662908539*^9}, {3.70590171019634*^9, 3.705901770678465*^9}, {
   3.705946466387496*^9, 3.70594647634916*^9}, {3.705948894588585*^9, 
   3.705948911527807*^9}, {3.7059503843261423`*^9, 3.705950385323543*^9}, {
   3.705954569440332*^9, 3.705954609562771*^9}, {3.7059547524915667`*^9, 
   3.705954785136129*^9}, {3.705955561975618*^9, 3.7059555640983047`*^9}, {
   3.705956181821609*^9, 3.705956223305291*^9}, {3.7059591001358137`*^9, 
   3.7059591187196407`*^9}, {3.7059591731652927`*^9, 3.705959196129171*^9}, {
   3.705959870942175*^9, 3.7059598995214853`*^9}, 3.705963626993038*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"feature", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7059636337097607`*^9, 3.705963635693637*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "11", ",", "27", ",", "30", ",", "39", ",", "43", ",", "70", ",", 
   "6.090073972131393`", ",", "\<\"Romance\"\>", 
   ",", "\<\"Suuri illusioni (1985)\"\>", ",", "4.`"}], "}"}]], "Output",
 CellChangeTimes->{3.705963636070786*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"trainingFeature", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "4"}]}], "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "2"}], ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "&"}], "/@", 
    RowBox[{"feature", "[", 
     RowBox[{"[", "All", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705901714049345*^9, 3.705901715831077*^9}, {
  3.705946537758575*^9, 3.705946597252083*^9}, {3.705946634652025*^9, 
  3.705946719426502*^9}, {3.705946853643268*^9, 3.705946859953978*^9}, {
  3.705948269394189*^9, 3.705948275851774*^9}, {3.705949005642078*^9, 
  3.7059490060786057`*^9}, {3.7059562395781317`*^9, 3.705956240096857*^9}, {
  3.705963715869164*^9, 3.705963730633463*^9}, {3.7059638073287888`*^9, 
  3.705963808375024*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"train", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"trainingFeature", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "\[GreaterEqual]", "0"}], "&"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705888455669897*^9, 3.705888498873867*^9}, {
   3.70589451417284*^9, 3.705894514891714*^9}, {3.705894867072895*^9, 
   3.705894870896069*^9}, 3.705946730487412*^9, {3.705947596839113*^9, 
   3.705947600820406*^9}, 3.7059482826183443`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"trainingFeature", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "<", "0"}], "&"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7058885010675907`*^9, 3.705888523640967*^9}, {
   3.7058945177900333`*^9, 3.705894527343845*^9}, {3.7058948780464277`*^9, 
   3.705894885107299*^9}, 3.705946731355507*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"train", "=", 
   RowBox[{"RandomSample", "@", "train"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7058949338344173`*^9, 3.705894953298543*^9}, {
  3.705895136631789*^9, 3.705895165842526*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"trainSplit", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{"train", ",", 
     RowBox[{"Floor", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "@", "train"}], "/", "5"}], ")"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.705895171060305*^9, 3.70589524621029*^9}, 
   3.705897991442871*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"movieList", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.705969063034164*^9, 3.705969066033203*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Suuri illusioni (1985)\"\>", ",", "\<\"Romance\"\>", ",", 
   "4.`"}], "}"}]], "Output",
 CellChangeTimes->{3.705969066375141*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "actMovieNumbers", "[", "\"\<Acosta, Minelva \\\"Mimie\\\"\>\"", "]"}], 
   " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "actMovieNumbers", "[", "\"\<Daubert, William \\\"Will\\\"\>\"", "]"}], 
   " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "actMovieNumbers", "[", "\"\<McDaniel, Jessica \\\"Ameelah\\\"\>\"", "]"}],
    " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "actMovieNumbers", "[", "\"\<Angelety, Natasha \\\"Sasha\\\"\>\"", "]"}], 
   " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "actMovieNumbers", "[", "\"\<Mcnulty, Tracy \\\"Stresh\\\"\>\"", "]"}], 
   "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "actMovieNumbers", "[", "\"\<Wolski, Sebastian \\\"Sebass\\\"\>\"", "]"}], 
   "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "actMovieNumbers", "[", "\"\<Scott, Nathaniel \\\"Nate\\\"\>\"", "]"}], 
   "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7059710106456738`*^9, 3.7059710264376297`*^9}, {
   3.705971091340127*^9, 3.705971114060627*^9}, {3.70597131528517*^9, 
   3.7059714405398073`*^9}, {3.705971644083351*^9, 3.705971676298911*^9}, 
   3.705972938764344*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"movieDirector", "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.705974314703939*^9, 3.7059743238621597`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"A Two Hour Delay (2001)\"\>", 
    "\[Rule]", "\<\"'Abd Al-Hamid, Ja'far\"\>"}], ",", 
   RowBox[{"\<\"Badgeless sur la Croisette (2012)\"\>", 
    "\[Rule]", "\<\"'Abd Al-Hamid, Ja'far\"\>"}], ",", 
   RowBox[{"\<\"Just Outside the Frame: The Profilmic Event and Beyond (2008)\
\"\>", "\[Rule]", "\<\"'Abd Al-Hamid, Ja'far\"\>"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.705974317879891*^9, 3.705974324188096*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"directorMovies", "=", 
   RowBox[{"Association", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"t", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
       RowBox[{"t", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<../data/director_movies.txt\>\"", ",", "\"\<String\>\""}], 
          "]"}], "~", "StringSplit", "~", "\"\<\\n\>\"", "~", "StringSplit", 
         "~", "\"\<\\t\\t\>\""}]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705974604008131*^9, 3.705974647274942*^9}, {
  3.705974712191635*^9, 3.705974746752967*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pm", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Print", "@", "i"}], ";", "\[IndentingNewLine]", 
    RowBox[{"training", "=", 
     RowBox[{"Catenate", "[", 
      RowBox[{"Drop", "[", 
       RowBox[{"trainSplit", ",", 
        RowBox[{"{", "i", "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"testing", " ", "=", " ", 
     RowBox[{"trainSplit", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"trainingMovies", "=", 
     RowBox[{"training", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{
         RowBox[{"-", "2"}], ";;", 
         RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", 
    RowBox[{"movieScore", " ", "=", " ", 
     RowBox[{"Association", "@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", "trainingMovies"}], 
       "]"}]}]}], ";", 
    RowBox[{"actScore2", "=", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"t", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
         RowBox[{"Mean", "[", 
          RowBox[{"Select", "[", " ", 
           RowBox[{
            RowBox[{"movieScore", "/@", 
             RowBox[{"t", "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;"}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MissingQ", "@", "#"}]}], "&"}]}], "]"}], "]"}]}], ",", 
        
        RowBox[{"{", 
         RowBox[{"t", ",", "actor"}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"actScore2", "=", 
     RowBox[{
      RowBox[{"ReplaceAll", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"{", "}"}], "]"}], "\[Rule]", "6.0176"}], "]"}], "[", 
      "actScore2", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"findMean", "[", "str_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tmp", " ", "=", " ", 
           RowBox[{"Mean", "[", 
            RowBox[{"actScore2", "/@", 
             RowBox[{"movieActor", "@", "str"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"tmp", "===", 
            RowBox[{"Mean", "[", 
             RowBox[{"{", "}"}], "]"}]}], ",", "10", ",", "tmp"}], "]"}]}], 
        "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"findMean", "[", "str_", "]"}], ":=", 
     RowBox[{"Mean", "[", 
      RowBox[{"WeightedData", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"actScore2", "/@", 
          RowBox[{"movieActor", "@", "str"}]}], ")"}], " ", ",", 
        RowBox[{"N", "@", 
         RowBox[{"Log", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"actMovieNumbers", "/@", 
             RowBox[{"movieActor", "@", "str"}]}], ")"}], "+", "1"}], " ", 
          "]"}]}]}], " ", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"movieScoreF", "[", "str_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "[", 
        RowBox[{"movieScore", "[", "str", "]"}], "]"}], ",", "Nothing", ",", 
       RowBox[{"movieScore", "[", "str", "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"directorScore", "=", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"t", "\[Rule]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tmp", "=", 
             RowBox[{"Mean", "[", 
              RowBox[{"movieScoreF", "/@", 
               RowBox[{"directorMovies", "[", "t", "]"}]}], "]"}]}], ";", 
            RowBox[{"tmp", "===", 
             RowBox[{"Mean", "[", 
              RowBox[{"{", "}"}], "]"}]}]}], ",", "0", ",", "tmp"}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"Keys", "@", "directorMovies"}]}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"transform", "[", "list_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"findMean", "@", 
              RowBox[{"t", "[", 
               RowBox[{"[", 
                RowBox[{"-", "2"}], "]"}], "]"}]}], ",", 
             RowBox[{"directorScore", "[", 
              RowBox[{"t", "[", 
               RowBox[{"[", 
                RowBox[{"-", "2"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"t", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"-", "3"}]}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"t", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "list"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"trainingF", "=", 
     RowBox[{"transform", "[", "training", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"testingF", "=", 
     RowBox[{"transform", "[", "testing", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p", "=", 
     RowBox[{"Predict", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"trainingF", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{"trainingF", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<RandomForest\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"testset", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
        RowBox[{"t", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "testingF"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tmp", "=", 
     RowBox[{"PredictorMeasurements", "[", 
      RowBox[{"p", ",", "testset"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"tmp", "[", "\"\<StandardDeviation\>\"", "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"pm", ",", "tmp"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "5"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",\

 CellChangeTimes->{{3.70589546725629*^9, 3.705895504514803*^9}, {
   3.70589554571253*^9, 3.705895718455051*^9}, {3.7058958636400967`*^9, 
   3.705895911975482*^9}, {3.705896146985751*^9, 3.705896154755711*^9}, {
   3.705896190007964*^9, 3.705896334631234*^9}, {3.705897368597191*^9, 
   3.705897369931838*^9}, {3.7058974338808117`*^9, 3.7058974750296183`*^9}, 
   3.705898013569848*^9, {3.705898858684855*^9, 3.70589885946903*^9}, {
   3.705899565082034*^9, 3.705899570089501*^9}, {3.705900139140503*^9, 
   3.705900159147534*^9}, {3.7059018314930553`*^9, 3.705901846486944*^9}, {
   3.705946948903064*^9, 3.705946963850882*^9}, {3.705948952907061*^9, 
   3.70594897257146*^9}, {3.705949071859201*^9, 3.7059490760765867`*^9}, {
   3.705955130645319*^9, 3.705955134401701*^9}, {3.705955338885998*^9, 
   3.7059553424419737`*^9}, {3.7059553745814*^9, 3.705955376810484*^9}, {
   3.705955410218156*^9, 3.705955413900382*^9}, {3.705955655545445*^9, 
   3.705955657753468*^9}, {3.7059566367556334`*^9, 3.7059566405270557`*^9}, {
   3.70595996802477*^9, 3.705959974021201*^9}, {3.7059602997513742`*^9, 
   3.705960308823217*^9}, {3.705963844793435*^9, 3.705963862598536*^9}, {
   3.7059638935868387`*^9, 3.705963895899447*^9}, {3.705964082921164*^9, 
   3.705964101502597*^9}, {3.7059648586578207`*^9, 3.705964876302758*^9}, 
   3.7059650165136957`*^9, {3.705965204035377*^9, 3.705965338503488*^9}, {
   3.705965553225803*^9, 3.7059655548949203`*^9}, {3.705965618430214*^9, 
   3.705965627105219*^9}, {3.705965668281301*^9, 3.7059656999527283`*^9}, 
   3.705965822613785*^9, {3.70596589257655*^9, 3.7059658981275387`*^9}, {
   3.7059663534935207`*^9, 3.7059663565809917`*^9}, {3.705966953065207*^9, 
   3.7059669584260178`*^9}, {3.705966991110929*^9, 3.7059670111291113`*^9}, {
   3.705967391072057*^9, 3.705967490630905*^9}, {3.7059677734716263`*^9, 
   3.7059677793325663`*^9}, {3.7059678918125877`*^9, 3.705967908031901*^9}, {
   3.705968407992931*^9, 3.705968413232256*^9}, {3.705968486493184*^9, 
   3.705968489909305*^9}, {3.705968565385054*^9, 3.705968569366702*^9}, {
   3.705968704928342*^9, 3.705968715749106*^9}, {3.705968802256819*^9, 
   3.7059690206686068`*^9}, 3.7059691716695347`*^9, {3.705969237013742*^9, 
   3.705969242395417*^9}, {3.705969402122364*^9, 3.705969405237636*^9}, {
   3.705969490827075*^9, 3.705969505789919*^9}, {3.705969627823498*^9, 
   3.705969640112831*^9}, {3.705970481206666*^9, 3.705970483774673*^9}, {
   3.7059705159492817`*^9, 3.70597056501538*^9}, {3.7059707492342377`*^9, 
   3.705970752686837*^9}, 3.705970806105178*^9, {3.705971121362919*^9, 
   3.7059711230019712`*^9}, {3.705972724953301*^9, 3.70597272925956*^9}, {
   3.705973137172946*^9, 3.705973192992539*^9}, {3.705974060571314*^9, 
   3.705974069009162*^9}, {3.705975708899733*^9, 3.7059757406339607`*^9}, {
   3.705975809125517*^9, 3.7059758214583473`*^9}, {3.7059765612637587`*^9, 
   3.705976577423174*^9}, {3.705976684095132*^9, 3.70597669373072*^9}, {
   3.705976817675413*^9, 3.705976856590794*^9}}],

Cell[CellGroupData[{

Cell[BoxData["1"], "Print",
 CellChangeTimes->{
  3.7059716792736588`*^9, 3.7059717650217447`*^9, 3.7059727309442253`*^9, {
   3.705973142288221*^9, 3.705973194664383*^9}, 3.705974069729562*^9, 
   3.705975754705805*^9, 3.7059758228028297`*^9, 3.7059765778387413`*^9, 
   3.705976695031332*^9, 3.705976857462078*^9}],

Cell[BoxData["1.1164542193938378`"], "Print",
 CellChangeTimes->{
  3.7059716792736588`*^9, 3.7059717650217447`*^9, 3.7059727309442253`*^9, {
   3.705973142288221*^9, 3.705973194664383*^9}, 3.705974069729562*^9, 
   3.705975754705805*^9, 3.7059758228028297`*^9, 3.7059765778387413`*^9, 
   3.705976695031332*^9, 3.70597699956682*^9}],

Cell[BoxData["2"], "Print",
 CellChangeTimes->{
  3.7059716792736588`*^9, 3.7059717650217447`*^9, 3.7059727309442253`*^9, {
   3.705973142288221*^9, 3.705973194664383*^9}, 3.705974069729562*^9, 
   3.705975754705805*^9, 3.7059758228028297`*^9, 3.7059765778387413`*^9, 
   3.705976695031332*^9, 3.705976999585101*^9}],

Cell[BoxData["1.1293534383737753`"], "Print",
 CellChangeTimes->{
  3.7059716792736588`*^9, 3.7059717650217447`*^9, 3.7059727309442253`*^9, {
   3.705973142288221*^9, 3.705973194664383*^9}, 3.705974069729562*^9, 
   3.705975754705805*^9, 3.7059758228028297`*^9, 3.7059765778387413`*^9, 
   3.705976695031332*^9, 3.705977141889905*^9}],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{
  3.7059716792736588`*^9, 3.7059717650217447`*^9, 3.7059727309442253`*^9, {
   3.705973142288221*^9, 3.705973194664383*^9}, 3.705974069729562*^9, 
   3.705975754705805*^9, 3.7059758228028297`*^9, 3.7059765778387413`*^9, 
   3.705976695031332*^9, 3.705977141901457*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.705976685943421*^9, 3.705976806223177*^9, 
  3.705977174514151*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"testF", "=", 
   RowBox[{"transform", "[", "test", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705965438049439*^9, 3.705965440579172*^9}, {
  3.7059672346443167`*^9, 3.705967244779517*^9}, {3.705967602861658*^9, 
  3.705967609433587*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p", "/@", 
  RowBox[{"testF", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7059605054293633`*^9, 3.705960505971899*^9}, {
   3.705961006455175*^9, 3.705961026003693*^9}, 3.705965452258596*^9, {
   3.7059738971968203`*^9, 3.705973900517255*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.57`", ",", "6.7700000000000005`", ",", "5.972`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.705960506496429*^9, 3.705961026295837*^9, 3.705965452897923*^9, 
   3.705967246270842*^9, {3.705967596943331*^9, 3.7059676109901457`*^9}, 
   3.7059683358807077`*^9, 3.705972307577544*^9, 3.7059737742287493`*^9, 
   3.705973893276713*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sd", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"pm", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<StandardDeviation\>\"", 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.705896239044763*^9, {3.7058970562042303`*^9, 3.7058970834160347`*^9}, {
   3.705897117133807*^9, 3.705897179039836*^9}, 3.705898349760479*^9, {
   3.7058995178544893`*^9, 3.705899520679878*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "@", "sd"}]], "Input",
 CellChangeTimes->{{3.705897180243259*^9, 3.705897182646003*^9}, {
  3.705897222041327*^9, 3.705897223063382*^9}}],

Cell[BoxData["1.1072946236115317`"], "Output",
 CellChangeTimes->{3.705897183035335*^9, 3.7058972243016863`*^9, 
  3.705898365991908*^9, 3.705899125497547*^9, 3.7058994924239073`*^9, 
  3.705899522892642*^9, 3.705899760428165*^9, 3.705948627241386*^9, 
  3.7059494918311996`*^9, 3.705951205341064*^9, 3.7059566116100197`*^9, 
  3.7059610899146557`*^9, 3.7059672691849623`*^9, 3.7059676188970346`*^9, 
  3.705968241989952*^9, 3.705968345206355*^9, 3.705970100833716*^9, 
  3.705972316180337*^9, 3.705973785106163*^9, 3.705976522517338*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<../result/p9_1(LogWeightedaverageS+actMovieNum+genre).txt\>\"", ",", 
   RowBox[{"Append", "[", 
    RowBox[{"sd", ",", 
     RowBox[{"Mean", "@", "sd"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.705897245551197*^9, 3.705897278903693*^9}, {
  3.7058991040281477`*^9, 3.7058991045203257`*^9}, {3.70596109655425*^9, 
  3.705961102820471*^9}, {3.705967623294118*^9, 3.7059676354296303`*^9}, {
  3.705968259177701*^9, 3.7059682657212057`*^9}, {3.7059683509804707`*^9, 
  3.705968364388733*^9}, {3.705972353253147*^9, 3.705972354457655*^9}, {
  3.7059738018489323`*^9, 3.705973804174045*^9}}],

Cell[BoxData["\<\"../result/p9_1(LogWeightedaverageS+actMovieNum+genre).txt\"\
\>"], "Output",
 CellChangeTimes->{3.705897287761566*^9, 3.705898430165163*^9, 
  3.705899145295381*^9, 3.705899527467272*^9, 3.705899763848359*^9, 
  3.70594864318449*^9, 3.705949498114317*^9, 3.705951212559217*^9, 
  3.705961103472625*^9, 3.705967638577435*^9, 3.705968365509782*^9, 
  3.7059723568774433`*^9, 3.705973806562887*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<../result/p9_1(LogWeightedaverageS+actMovieNum+genre).pdf\>\"", ",", 
   RowBox[{
    RowBox[{"pm", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "[", "\"\<ComparisonPlot\>\"", "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.7059673410790243`*^9, {3.7059676503798027`*^9, 3.705967666159689*^9}, {
   3.705973813884385*^9, 3.7059738195166063`*^9}, {3.705973949204475*^9, 
   3.7059739596784687`*^9}}],

Cell[BoxData["\<\"../result/p9_1(LogWeightedaverageS+actMovieNum+genre).pdf\"\
\>"], "Output",
 CellChangeTimes->{
  3.705967281139344*^9, 3.705967342222329*^9, {3.7059676414320993`*^9, 
   3.7059676673893013`*^9}, 3.705968370698584*^9, 3.705972667343589*^9, {
   3.7059738099545918`*^9, 3.7059738208774033`*^9}, 3.705973963801403*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 655},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 169, 3, 32, "Input"],
Cell[752, 27, 117, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[906, 33, 93, 1, 63, "Subchapter"],
Cell[1002, 36, 265, 4, 32, "Input"],
Cell[1270, 42, 618, 19, 32, "Input"],
Cell[1891, 63, 297, 7, 32, "Input"],
Cell[2191, 72, 151, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[2367, 79, 127, 2, 32, "Input"],
Cell[2497, 83, 275, 4, 32, "Output"]
}, Open  ]],
Cell[2787, 90, 377, 10, 32, "Input"],
Cell[3167, 102, 349, 9, 32, "Input"],
Cell[3519, 113, 585, 17, 32, "Input"],
Cell[4107, 132, 570, 17, 54, "Input"],
Cell[4680, 151, 751, 18, 54, "Input"],
Cell[5434, 171, 305, 7, 32, "Input"],
Cell[5742, 180, 1504, 42, 201, "Input"],
Cell[7249, 224, 191, 4, 32, "Input"],
Cell[7443, 230, 650, 19, 54, "Input"],
Cell[8096, 251, 356, 8, 54, "Input"],
Cell[8455, 261, 352, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[8832, 275, 456, 12, 32, "Input"],
Cell[9291, 289, 502, 9, 35, "Output"]
}, Open  ]],
Cell[9808, 301, 1203, 27, 117, "Input"],
Cell[11014, 330, 467, 13, 32, "Input"],
Cell[CellGroupData[{
Cell[11506, 347, 129, 2, 32, "Input"],
Cell[11638, 351, 218, 3, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11905, 360, 151, 2, 63, "Subchapter"],
Cell[CellGroupData[{
Cell[12081, 366, 151, 3, 32, "Input"],
Cell[12235, 371, 176, 4, 32, "Output"]
}, Open  ]],
Cell[12426, 378, 442, 13, 32, "Input"],
Cell[12871, 393, 1012, 25, 75, "Input"],
Cell[13886, 420, 387, 11, 32, "Input"],
Cell[14276, 433, 458, 13, 32, "Input"],
Cell[14737, 448, 541, 15, 54, "Input"],
Cell[15281, 465, 461, 11, 32, "Input"],
Cell[15745, 478, 2483, 59, 117, "Input"],
Cell[CellGroupData[{
Cell[18253, 541, 149, 3, 32, "Input"],
Cell[18405, 546, 457, 9, 54, "Output"]
}, Open  ]],
Cell[18877, 558, 817, 20, 32, "Input"],
Cell[19697, 580, 559, 14, 32, "Input"],
Cell[20259, 596, 475, 13, 32, "Input"],
Cell[20737, 611, 227, 5, 32, "Input"],
Cell[20967, 618, 359, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[21351, 633, 2957, 65, 264, "Input"],
Cell[CellGroupData[{
Cell[24333, 702, 692, 10, 24, "Print"],
Cell[25028, 714, 710, 10, 24, "Print"],
Cell[25741, 726, 692, 10, 24, "Print"],
Cell[26436, 738, 710, 10, 24, "Print"],
Cell[27149, 750, 691, 10, 24, "Print"],
Cell[27843, 762, 710, 10, 24, "Print"],
Cell[28556, 774, 694, 10, 24, "Print"],
Cell[29253, 786, 710, 10, 24, "Print"],
Cell[29966, 798, 692, 10, 24, "Print"],
Cell[30661, 810, 710, 10, 24, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31420, 826, 249, 6, 32, "Input"],
Cell[31672, 834, 206, 5, 32, "Output"]
}, Open  ]],
Cell[31893, 842, 521, 14, 32, "Input"],
Cell[CellGroupData[{
Cell[32439, 860, 168, 3, 32, "Input"],
Cell[32610, 865, 352, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32999, 875, 371, 8, 32, "Input"],
Cell[33373, 885, 286, 4, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33708, 895, 201, 3, 63, "Subchapter"],
Cell[33912, 900, 442, 13, 32, "Input"],
Cell[34357, 915, 1012, 25, 75, "Input"],
Cell[35372, 942, 387, 11, 32, "Input"],
Cell[35762, 955, 458, 13, 32, "Input"],
Cell[36223, 970, 541, 15, 54, "Input"],
Cell[36767, 987, 461, 11, 32, "Input"],
Cell[37231, 1000, 2174, 50, 96, "Input"],
Cell[CellGroupData[{
Cell[39430, 1054, 151, 3, 32, "Input"],
Cell[39584, 1059, 274, 6, 32, "Output"]
}, Open  ]],
Cell[39873, 1068, 1018, 25, 32, "Input"],
Cell[40894, 1095, 559, 14, 32, "Input"],
Cell[41456, 1111, 475, 13, 32, "Input"],
Cell[41934, 1126, 227, 5, 32, "Input"],
Cell[42164, 1133, 359, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[42548, 1148, 151, 3, 32, "Input"],
Cell[42702, 1153, 174, 4, 32, "Output"]
}, Open  ]],
Cell[42891, 1160, 1378, 39, 159, "Input"],
Cell[CellGroupData[{
Cell[44294, 1203, 182, 4, 32, "Input"],
Cell[44479, 1209, 511, 10, 78, "Output"]
}, Open  ]],
Cell[45005, 1222, 779, 21, 96, "Input"],
Cell[CellGroupData[{
Cell[45809, 1247, 9784, 229, 663, "Input"],
Cell[CellGroupData[{
Cell[55618, 1480, 316, 5, 24, "Print"],
Cell[55937, 1487, 333, 5, 24, "Print"],
Cell[56273, 1494, 316, 5, 24, "Print"],
Cell[56592, 1501, 334, 5, 24, "Print"],
Cell[56929, 1508, 316, 5, 24, "Print"]
}, Open  ]],
Cell[57260, 1516, 124, 2, 32, "Output"]
}, Open  ]],
Cell[57399, 1521, 277, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[57701, 1531, 325, 7, 32, "Input"],
Cell[58029, 1540, 376, 8, 32, "Output"]
}, Open  ]],
Cell[58420, 1551, 521, 14, 32, "Input"],
Cell[CellGroupData[{
Cell[58966, 1569, 168, 3, 32, "Input"],
Cell[59137, 1574, 538, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59712, 1586, 653, 12, 54, "Input"],
Cell[60368, 1600, 413, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60818, 1611, 458, 11, 54, "Input"],
Cell[61279, 1624, 335, 5, 32, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

